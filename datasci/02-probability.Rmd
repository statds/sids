---
output:
  pdf_document: default
  html_document: default
---
# Probability and Paradoxes {#ch:probability}
<!-- https://en.wikipedia.org/wiki/Category:Probability_theory_paradoxes -->

## Probability

<!-- ![](images/random.png) -->
<!-- ```{r, fig.align="center", echo=FALSE, out.width="70%"} -->
<!-- knitr::include_graphics("images/random.png") -->
<!-- ``` -->

The world is random. Probability theory has been used to quantify the randomness. We will go through examples to see how probability helps interpret phenomena in real life and how probability may counter intuition. 

Some concepts:

- Experiment: a situations in which the outcome occur randomly.
- Sample Space: the set of all possible outcomes in an experiment.
- Event: a subset of the sample space is called an event; an event occur if the outcome from an experiment belong to the event.
- Probability: assuming the elements of the sample space all have
  equal chance to occur, the probability of event $A$ is
  \begin{equation*}
    P(A)=\frac{n}{N}=\frac{\text{number of elements in A}}{\text{total number of outcomes}},
  \end{equation*}
  where $n$ is the number of elements in $A$ and $N$ is the number of elements in the sample space. 
  Note that this formula holds only if all the outcomes are
    equally likely.

## Example: elevator waiting time
  Mr. Smith works on the 13th floor of a 15 floor building. The only
  elevator moves continuously through floors 1, 2, . . . 14, 15, 14,
  . . . 2, 1, 2, . . . , except that it stops on a floor on which
  the button has been pressed. Assume that time spent loading and
  unloading passengers is very small compared to the travelling time.
  Mr. Smith complains that at 5pm, when he wants to go home, the
  elevator almost always goes up when it stops on his floor. What is
  the explanation? 

```{r}
set.seed(123)
n.days = 10000 ## number of days to consider
S = 15 - 1 ## sample space, possible location of elevator
elevator = runif(n.days, min=1, max=15) ## outcome of experiments
up = elevator < 13 ## Whether the event occur
sum(up) / n.days
```

## Simpson's Paradox

 It is a phenomenon in which a trend appears in several different groups of data but disappears or reverses when these groups are combined. 

**An urn example**: 
  A black urn contains 5 red and 6 green balls, and a white urn
  contains 3 red and 4 green balls. You are allowed to choose an urn
  and then choose a ball at random from the urn. If you choose a red
  ball, you get a prize. Which urn should you choose to draw from?

  \begin{itemize}
  \item If you draw from the black urn, the probability of choosing
    a
    red ball is 5/11 = .455
  \item If you choose to draw
    from the white urn, the probability of choosing a red ball is
    3/7 = .429.
  \end{itemize}
 So, you should choose to draw from the black urn.

  Now consider another game in which a second black urn has 6 red and
  3 green balls, and a second white urn has 9 red and 5 green balls.

  \begin{itemize}
  \item If you draw from the black urn, the probability of a red
    ball is 6/9 = .667
  \item if you choose to draw from the white urn, the probability if
    9/14 = .643.
  \end{itemize}
  So, again you should choose to draw from the black urn.

  In the final game, the contents of the second black urn are added to
  the first black urn, and the contents of the second white urn are
  added to the first white urn. Again, you can choose which urn to
  draw from. Which should you choose?

  Intuition says choose the black urn, but let's calculate the
  probabilities.
  \begin{itemize}
  \item The black urn now contains 11 red and 9 green balls,
    so the probability of drawing a red ball from it is 11/20=0.55
  \item The white urn now contains 12 red and 9 green balls, so the
    probability of drawing a red ball from it is 12/21= .571.
  \end{itemize}
  So, you should choose the white urn.

  <!-- This counterintuitive result is an example of Simpson's paradox. -->

**UC Berkeley gender bias** 
A famous example of Simpson's paradox is a study of gender bias among graduate school admissions to University of California, Berkeley. In 1973 UC Berkeley was sued for sex-discrimination. Here are the overall numbers for the six largest departments in fall admission of 1973.

\begin{tabular}{cccc}\hline
 \multicolumn{2}{c}{Men} & \multicolumn{2}{c}{Women} \\\hline
 Applicants & Admitted & Applicants & Admitted \\\hline
 2691       & 1198(44.5\%)     & 1835       & 557(30.4\%)     \\\hline
\end{tabular}

This table shows that men were more likely than women to be admitted, and the difference was so significant. UC Berkley set out to find the main culprits of this gender discrimination. To do this they broke open the data to see which departments were mainly responsible for this gender bias. Here are the numbers for each departments.

\begin{tabular}{lcrcr}\hline
  & \multicolumn{2}{c}{Men}  & \multicolumn{2}{c}{Women} \\\hline
 & Applicants  & Admitted & Applicants  & Admitted \\\hline
A     & 825  & 512(62\%) & 108  &  89(82\%) \\ 
B     & 560  & 353(63\%) & 25   &  17(68\%) \\
C     & 325  & 120(37\%) & 593  & 202(34\%) \\
D     & 417  & 138(33\%) & 375  & 131(35\%) \\
E     & 191  & 53 (28\%) & 393  &  94(24\%) \\
F     & 373  & 22 ( 6\%) & 341  &  24( 7\%) \\\hline
\end{tabular}

Things get funny after we breaking divide the data according different departments. For the six departments, four of them accepted women more than men. The gender bias was in favour for the women. 
To explain this, Bickel et al. (1975) concluded that women tended to apply to more competitive departments with low rates of admission even among qualified applicants (such as in the English Department), whereas men tended to apply to less competitive departments with high rates of admission among the qualified applicants (such as in engineering and chemistry).

```{r, echo=TRUE, comment=""}
set.seed(2021)
g = 4
n = 40
z = rep(1:4, each=n)
x = runif(n*g, 0, 2) + z
y = 2 * z - x + rnorm(n*g)
plot(x, y)
plot(x, y, pch=rep(1:g, each=n), col=rep(1:g, each=n))
```

## The Two Child Problem

## 100 prisoners problem
