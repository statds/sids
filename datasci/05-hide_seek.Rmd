# Estimation: A hide and seek game with the nature {#ch:estimation}

Consider this game setup. We have a random sample of size $n$ from a normal
distribution $N(\mu, 1)$, where $\mu$ is unknown, and we want to estimate $\mu$
with this sample. An estimator is a quantity constructed from the observed
sample, that is, it is a statistic. What estimators can we construct? How do we
assess which is better?


Let's set up a true $\mu$ that no one knows and generate a random sample of size
$n = 20$.
```{r}
set.seed(123) # each student can contribute a digit to make mu really unknown
mu  <- runif(1, min =- 10, max = 10)
n <- 20
x  <- rnorm(n, mean = mu, sd = 1)
summary(x)
```


**Estimators**

Let us consider a few candidate estimators

+ Sample mean,
+ Sample median.
+ Midrange.

The three estimates based on the observed sample are
```{r}
mu1 <- mean(x)
mu2 <- median(x)
mu3 <- mean(range(x))
(estimates <- c(mu1, mu2, mu3))
```

**Mean Squared Error**
To assess which estimator is better, we compare them with the true value of
$\mu$. The squared error of an estimator $\hat\mu$ of $\mu$ is
$(\hat\mu - \mu)^2$.
For the three estimates based on the given sample, we have:
```{r}
(estimates - mu)^2
```

Note that this comparison is for only the given sample. A good estimator may by
chance behaves worse than a bad estimator. A real assessment of the quality of
the estimator should be based on a large number of replicates, where we can
check which estimator performs the best on average. To do so, we need to play
this game repeatedly, collect the squared errors of the estimators, and compare
their means, that is, mean squared error.


Now the game becomes a racing game. We do it through a simulation study.
Let us construct a function to do replicate of such game.
```{r}
do1rep <- function(n, mu) {
    x <- rnorm(n, mean = mu, sd = 1)
    mu1 <- mean(x)
    mu2 <- median(x)
    mu3 <- mean(range(x))
    return((c(mu1, mu2, mu3) - mu)^2)
}
```

Each time we call this function, the experiment is done and the squared errors
of the three estimators are returned.
```{r}
do1rep(n, mu)
do1rep(n, mu)
```


Which estimator is winning the game? Let's repeat the experiment 1000 times and
compare the MSE.
```{r}
nrep <- 1000
sim <- replicate(nrep, do1rep(n, mu))
rowMeans(sim)
```

The first estimator, the sample mean, is a clear winner!


The area of a circle with radiur $r$ is

\begin{align}
	R = \pi r^2.
(\#eq:area)
\end{align}


